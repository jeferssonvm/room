'use strict';

var identity = require('../nodes/identity.js');

function mapIncludes(ctx, items, search) {
  var uniqueKeys = ctx.options.uniqueKeys;
  if (uniqueKeys === false) return false;
  var isEqual = typeof uniqueKeys === 'function' ? uniqueKeys : function (a, b) {
    return a === b || identity.isScalar(a) && identity.isScalar(b) && a.value === b.value && !(a.value === '<<' && ctx.schema.merge);
  };
  return items.some(function (pair) {
    return isEqual(pair.key, search);
  });
}

exports.mapIncludes = mapIncludes;